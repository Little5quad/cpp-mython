# Mython

Интерпретатор языка Mython.

Реализация на C++ интерпретатора языка программирования Mython — упрощённое подмножество Python. Язык является динамически типизированным, поддерживает классы и наследование. Все методы в классах по умолчанию виртуальные.

## Сборка проекта
Для сборки программы необходим компилятор С++ поддерживающий стандарт не ниже С++17 и установленная утилита CMake.

## Использование интерпретатора
На вход поступает текст программы, а интерпретатор должен вывести в выходной поток результат всех команд print. Примеры вызовов в main.cpp

## Описание языка Mython
### Числа
В языке Mython используются только целые числа. С ними можно выполнять обычные арифметические операции: сложение, вычитание, умножение, целочисленное деление.

### Строки
Строковая константа в Mython — это последовательность произвольных символов, размещающаяся на одной строке и ограниченная двойными кавычками " или одинарными '. Поддерживается экранирование спецсимволов '\n', '\t', '\'' и '\"'. Примеры строк в Mython:

- `` "hello" ``
- `` 'world' ``
- `` 'long string with a double quote " inside' ``
- `` "another long string with a single quote ' inside" ``
- `` "string with a double quote \" inside" ``
- `` 'string with a single quote \' inside' ``
- `` '' ``, `` "" `` — пустые строки. Строки в Mython — неизменяемые.

## Логические константы и None
Кроме строковых и целочисленных значений язык Mython поддерживает логические значения `` True `` и `` False ``. Есть также специальное значение `` None ``, аналог `` nullptr `` в С++. В отличие от C++, логические константы пишутся с большой буквы.

## Комментарии
Mython поддерживает однострочные комментарии, начинающиеся с символа #. Весь следующий текст до конца текущей строки игнорируется. # внутри строк считается обычным символом.
```
# это комментарий
x = 5 #это тоже комментарий
# в следующей строке # - обычный символ
hashtag = "#природа"
```
## Идентификаторы
Идентификаторы в Mython используются для обозначения имён переменных, классов и методов. Об этом далее. Идентификаторы формируются так же, как в большинстве других языков программирования: начинаются со строчной или заглавной латинской буквы либо с символа подчёркивания. Потом следует произвольная последовательность, состоящая из цифр, букв и символа подчёркивания.

Примеры правильных идентификаторов: `` x ``, `` _42 ``, `` do_something ``, `` int2str ``. Примеры неправильных идентификаторов:

`` 4four `` — начинается с цифры;
`` one;two `` — содержит символ, который не относится к цифрам, буквам или знакам подчёркивания.

## Классы
Объявление класса начинается с ключевого слова class, за которым следует идентификатор имени и объявление методов класса. Пример класса «Прямоугольник»:
```
class Rect:
  def __init__(w, h):
    self.w = w
    self.h = h

  def area():
    return self.w * self.h
```
Специальный метод ``__init__`` играет роль конструктора — он автоматически вызывается при создании нового объекта класса. Метод ``__init__`` может отсутствовать.

Неявный параметр всех методов — специальный параметр ``self``, аналог указателя ``this`` в C++. Параметр ``self`` ссылается на текущий объект класса.

Поля не объявляются заранее, а добавляются в объект класса при первом присваивании. Поэтому обращения к полям класса всегда надо начинать с ``self.``, чтобы отличать их от локальных переменных.

Все поля объекта — публичные.
```
r = Rect(10, 5)
```
В этой программе создаётся новый объект класса Rect. При вызове метода ``__init__`` параметр ``w`` будет иметь значение 10, а параметр ``h`` — 5. Созданный прямоугольник будет доступен в переменной ``r``.

## Типизация
Mython — это язык с динамической типизацией. В нём тип каждой переменной определяется во время исполнения программы и может меняться в ходе её работы. Поэтому вместо «присваивания переменной значения» лучше говорить о «связывании значения с некоторым именем». Благодаря динамической типизации при первом использовании переменной не надо указывать её тип. Пример:
```
x = 4  # переменная x связывается с целочисленным значением 4
# следующей командой переменная x связывается со значением 'hello'
x = 'hello'
y = True
x = y
```
## Операции
В Mython определены:

- Арифметические операции для целых чисел, деление выполняется нацело. Деление на ноль вызывает ошибку времени выполнения.
- Операция конкатенации строк, например: s = 'hello, ' + 'world'.
- Операции сравнения строк и целых чисел ==, !=, <=, >=, <, >; сравнение строк выполняется лексикографически.
- Логические операции and, or, not.
- Унарный минус.
Приоритет операций (в порядке убывания приоритета):

- Унарный минус.
- Умножение и деление.
- Сложение и вычитание.
- Операции сравнения.
- Логические операции.
Порядок вычисления выражений может быть изменён скобками:
```
print 2 + 3 * 4   # выведет 14
print (2 + 3) * 4 # выведет 20
```
В Mython операция сложения кроме чисел и строк применима к объектам классов со специальным методом ``__add__``:
```
class Fire:
  def __init__(obj):
    self.obj = obj

  def __str__():
    return "Burnt " + str(self.obj)

class Tree:
  def __str__():
    return "tree"

class Matches: # Спички
  # операция сложения спичек с другими объектами превращает их в огонь
  def __add__(smth):
    return Fire(smth)

result = Matches() + Tree()
print result             # Выведет Burnt tree
print Matches() + result # Выведет Burnt Burnt tree
```
Операции сравнения применяются не только к числам и строкам, но и к объектам классов, имеющих методы ``__eq__`` (проверка «равно») и ``__lt__`` (проверка «меньше»). Используя эти методы, можно реализовать все операции сравнения.
```
class Person:
  def __init__(name, age):
    self.name = name
    self.age = age
  def __eq__(rhs):
    return self.name == rhs.name and self.age == rhs.age
  def __lt__(rhs):
    if self.name < rhs.name:
        return True
    return self.name == rhs.name and self.age < rhs.age

print Person("Ivan", 10) <= Person("Sergey", 10) # True
print Person("Ivan", 10) <= Person("Sergey", 9)  # False
```
